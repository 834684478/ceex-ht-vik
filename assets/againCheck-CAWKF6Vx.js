import{r as n,u as M,o as x,c as f,a as F,b as a,t as u,n as _,h as L,v as N,i as R,j as h,f as S,g}from"./index-DvRa-Evj.js";import{b as O}from"./bannerComponent-D4Az8HOE.js";import{a as m}from"./index-DYDmJwWO.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"root"},U={style:{"margin-top":"22px"}},H={class:"title"},J={class:"accountPanel"},K=["placeholder"],Q={style:{width:"65px","text-align":"right"}},W={__name:"againCheck",setup(X){const d=n(null),w=M(),k=S(),l=n(""),v=n(!1),i=n(""),r=n(""),c=n(""),y=n(""),I=n(""),s=n(0),b=n(""),o=w.query;console.log("所有查询参数:",o),(()=>{switch(o.authType){case"MOBILE":r.value="手机验证码",c.value="请输入手机验证码";break;case"EMAIL":r.value="邮箱验证码",c.value="请输入邮箱验证码";break;case"GA":r.value="谷歌验证码",c.value="请输入谷歌验证码";break;case"ID_CARD":r.value="信息验证",c.value="请输入信息验证码",y.value="为了保障您的账户安全，请填写您在交易所的实名有效证件";break;default:console.log("其他");break}})();const C=async()=>{try{const e=await navigator.clipboard.readText();return console.log("剪贴板内容:",e),i.value=e,e}catch(e){return console.error("无法读取剪贴板:",e),i.value="",""}},$=async()=>{const e=await C();l.value=e},q=()=>{l.value=i.value,console.log("paste",i.value)},P=()=>{s.value>0||(console.log("触发发送验证码极验"),b.value="sendCode",d.value&&d.value.verify())},A=()=>{s.value=60;const e=setInterval(()=>{s.value--,s.value<=0&&clearInterval(e)},1e3)},V=()=>{if(!o.account){alert("账号信息不完整，无法发送验证码");return}m.sendVerifyCodeFindPassword({request_id:o.requestId}).then(e=>{console.log("发送验证码成功:",e),A()}).catch(e=>{console.error("发送验证码失败:",e),alert(`发送失败：${e.message||"请稍后重试"}`)})},T=()=>l.value?!0:(alert("请输入验证码"),!1),G=function(e){console.log("极验handler被调用"),d.value=e,e.onReady(function(){console.log("极验验证码准备就绪")}).onSuccess(function(){var t=e.getValidate();if(!t)return alert("请完成验证");console.log("验证成功，参数:",t),b.value==="sendCode"&&V()}).onError(function(t){console.error("极验验证出错:",t)})},B=()=>{T()&&(console.log("账号验证通过，直接提交"),D())},D=()=>{if(!o.requestId){alert("请求参数不完整，无法提交");return}m.sendVerifyCodeFindPassword({request_id:o.requestId}).then(e=>{console.log("验证成功:",e),k.push({path:"/forgetSetPassword",query:{order_id:e.data.orderId||e.orderId,request_id:o.requestId}})}).catch(e=>{console.error("验证失败:",e),alert(`验证失败：${e.message||"请稍后重试"}`)})},E=()=>{m.register({captcha_id:"d9b22c2488def2cfa35aa4b6a4cbe74d"}).then(e=>{console.log("极验初始化数据获取成功:",e),I.value=e.challenge,window.initGeetest?(console.log("调用initGeetest初始化极验"),window.initGeetest({gt:e.gt,challenge:e.challenge,offline:!e.success,new_captcha:e.new_captcha,product:"bind"},G)):console.error("未找到initGeetest函数")}).catch(e=>{console.error("获取极验初始化数据失败:",e)})};return x(async()=>{await C(),E()}),(e,t)=>(g(),f("div",z,[F(O,{title:e.$t("二次验证"),content:e.$t(y.value)},null,8,["title","content"]),a("main",U,[a("div",H,u(e.$t(r.value)),1),a("section",{class:_(["inputPanel",{borderNone:!v.value}])},[a("div",J,[L(a("input",{type:"text",placeholder:e.$t(c.value),onPaste:$,"onUpdate:modelValue":t[0]||(t[0]=p=>l.value=p),onFocus:t[1]||(t[1]=p=>v.value=!0),onBlur:t[2]||(t[2]=p=>v.value=!1)},null,40,K),[[N,l.value]]),a("div",Q,[h(o).authType=="GA"?(g(),f("span",{key:0,class:"paste",onClick:q},u(e.$t("粘贴")),1)):h(o).authType=="MOBILE"||h(o).authType=="EMAIL"?(g(),f("span",{key:1,class:_(["paste",{disabled:s.value>0}]),onClick:P},u(s.value>0?`${s.value}s`:e.$t("发送")),3)):R("",!0)])])],2),a("button",{id:"submit",class:"login",onClick:B},u(e.$t("提交")),1)])]))}},ne=j(W,[["__scopeId","data-v-d4eca32a"]]);export{ne as default};
