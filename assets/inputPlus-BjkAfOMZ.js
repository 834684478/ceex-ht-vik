import{k as j,r as n,x as U,o as O,m as J,c as i,b as c,i as T,t as g,h as q,C as Z,p as B,n as v,e as z,g as u}from"./index-P6PzsWOz.js";import{v as $,a as _}from"./help-CmPQ-lNE.js";import{a as b}from"./index-B8KhkOGp.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAXlJREFUSA3tluGNgzAMhTtCNzhG6AgdoRtdN+ltxgiWSBwHeiWnhy4ShBIcinT3o5GiCBL7e7YDyeHwbv8tAyJSGWPOuW6tPe2imygcWeTTWkeWJWg6s9SW5UYk1SYRzHwpAaaiIKBp+FIEH6DKCFNg+qyGI0W/6VKlNgXNnz2hZKuRoz5zY119l+wM83UV/Gq0vu2CE59ky1MWTLY7LanWvAcUre/7GTyE8LEIN0bOGsCzNRE6kEMI3neTqPH97w6eQdspFEI3geH48egDu7R2EjTQTWDxbczeDK6FbgLD6H7/nsFLoJvBKRy7dtwgAmtyfVONo8Nx5BGsgcL+JTAcjOFa6CqYRKoYXW4EvAQ6+Fo7qy3rz96cuMmck3rx5xEnjJHrxGhl0yjX3qL/xZGIjrtG7aRGCReB4wkc3spIsp8QfDC3ZbeQAe6G+9Oq82ciDTsqhsbokaLG8pctEAAg9gkFxa0jgnIjrq44NnMdV+Ccj/fcn2TgBybTZAmztqGqAAAAAElFTkSuQmCC",ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAYlJREFUSA3tlk1ugzAQhXMEbtAeIUdgUwmzYtlgI3GE9gTtBXqArujNOALLSokdVy/VRMjg8U+D1EWQ0Ah7Mt+bcRhmt7tf/60C39Xz46lSJXcfn9r9TXTbsilMrd606CYtlI27u9HUcoDQLBFaHJo0oCusG7VQTRL8F+oGyn6Og6NERlzURpY2KGiyZV8EM9e1HOLOMgi8Cj9V6j0I5rI1/es1mCuO29NCTSz4WLd7NyA9m49PiwuW1shye+Rj6/bBC8c7So5zi2zm1xxOUNrX/ctCGGIhdjIYP3QBeHbXzivVoASywWtwyhKWg/4pY1LuZhkD3QwMMSTMZzcrdQieDXZLjDN11zh4Fth9neZ/JBee9TqhT/vOiABzKPlye+QT/FajvZHzwnqaw8WP2xNy9DYP2kBDXwCjh4D1D4ep5EDxvdY2fcFmnSxCjtHTCCaH22V9iBsEqBSAGyExvgSbg8dnwiRD8ZIsSnSs5FeigAn/EwyKSTCfM77VaALcHX2WPsh9fYsK/ADMpECm50D/fwAAAABJRU5ErkJggg==",se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAVFJREFUSA3tlsGtgzAMhjvCDwvABG1H6L3v8O5MUJYom7QXFmIBxASMkPdMcIUCBMdBag+NFEVtJH+2f8D/4fBdn9YBADmAy8Y+75I3hpXegaQHEiPcLZA+KFFVEgB+A4FuYi3FCIKPUDeQ8rcQbrVMWmFbJcn0pNhm5VYfsZ4SsAHSSgCOq/Z2K83xeHIT6r1gAOeYFhOUVtd1C3Bkq3D7jurazNCBbIwpisKpGpfdwS60LEsHSsUowBS4aRqTZfksoAyqAF+vP9y9GVwOVYDpYavregYPgyrBLpye2ula1pRg063QmANMK2ewDBpR8RJcDt0G5wzwnVR5GHQA+2d15Ch0dH1p3K5+PPjif5BUvmp1d3hw/NXTuo4gx7FWJf9PhkDmRt5iBLgVIzzGEJABCLM+Ezg5yycQNKMJWIlcB4N8p53Vm/ZWpqUP9L3buwN/aHygC2ta2eQAAAAASUVORK5CYII=",oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAYlJREFUSA3tlk1ugzAQhXMEbtAeIUdgUwmzYtlgI3GE9gTtBXqArujNOALLSokdVy/VRMjg8U+D1EWQ0Ah7Mt+bcRhmt7tf/60C39Xz46lSJXcfn9r9TXTbsilMrd606CYtlI27u9HUcoDQLBFaHJo0oCusG7VQTRL8F+oGyn6Og6NERlzURpY2KGiyZV8EM9e1HOLOMgi8Cj9V6j0I5rI1/es1mCuO29NCTSz4WLd7NyA9m49PiwuW1shye+Rj6/bBC8c7So5zi2zm1xxOUNrX/ctCGGIhdjIYP3QBeHbXzivVoASywWtwyhKWg/4pY1LuZhkD3QwMMSTMZzcrdQieDXZLjDN11zh4Fth9neZ/JBee9TqhT/vOiABzKPlye+QT/FajvZHzwnqaw8WP2xNy9DYP2kBDXwCjh4D1D4ep5EDxvdY2fcFmnSxCjtHTCCaH22V9iBsEqBSAGyExvgSbg8dnwiRD8ZIsSnSs5FeigAn/EwyKSTCfM77VaALcHX2WPsh9fYsK/ADMpECm50D/fwAAAABJRU5ErkJggg==",le={class:"root"},ne={for:""},re=["type","placeholder"],ie=["disabled"],ce={key:0,class:"errorMessage"},ue={key:1,class:"showCondition"},de={__name:"inputPlus",props:{labelTitle:String,title:String,type:{type:String,default:"normal"},account:String,accountType:String,inputType:{type:String,default:""},width:{type:Number,default:335},height:{type:Number,default:35},placeholder:String,placeholderSize:String,placeholderColor:String,iconUrl:String,iconSize:{type:Number,default:35},iconPosition:Object,showErrorMessage:Boolean,showCondition:Boolean,to:String,autoGeetest:Boolean,verifyCodeType:{type:String,default:"1"},hasError:{type:Boolean,default:!1},errorMessage:{type:String,default:"密码输入错误"},passwordError:{type:Boolean,default:!1}},emits:["nextStep","sendValue","validChange"],setup(o,{expose:D,emit:G}){const L=j(),t=o,s=G,a=n(""),d=n(!1),A=n(!1),h=n(!1),f=n(!1),m=n("发送"),w=n(6),C=n(),I=n(""),E=n("");let S=null;const r=U(()=>{const e=a.value;return{isLengthValid:e.length>=8&&e.length<=20,hasUpperLowerNumber:/[A-Z]/.test(e)&&/[a-z]/.test(e)&&/[0-9]/.test(e)}}),V=U(()=>r.value.isLengthValid&&r.value.hasUpperLowerNumber),y=()=>{if(!a.value)return!1;if(t.accountType==="phone"||t.inputType==="phone"){const e=localStorage.getItem("nationalCode")||"86";return $(a.value,e)}else{if(t.accountType==="email"||t.inputType==="email")return _(a.value);if(t.type==="password")return V.value}return!0},R=()=>{d.value=!0,A.value=!1,s("validChange",!0),t.type==="password"&&s("sendValue",a.value,y())},k=()=>{if(d.value=!1,a.value){const e=y();t.type==="password"?s("sendValue",a.value,V.value):s("validChange",e)}else t.type==="password"?s("sendValue","",!1):s("validChange",!1)},F=()=>{if(t.type==="code"){if(a.value=a.value.replace(/[^0-9]/g,"").slice(0,6),a.value.length===6){const e=JSON.stringify({verify_code:a.value,order_id:E.value});console.log("nextStep执行了"),s("nextStep",e)}}else if(t.type==="password")s("sendValue",a.value,V.value);else if(a.value&&(t.inputType==="email"||t.inputType==="phone")){const e=y();s("validChange",e)}},Y=()=>t.type==="password"?h.value?"text":"password":"text",x=()=>{h.value=!h.value},N=e=>L.theme==="dark"?`url(${e?te:ae})`:`url(${e?se:oe})`,H=()=>{if(!a.value)return t.type==="password"?"请输入密码":"请输入内容";if(t.accountType==="phone"||t.inputType==="phone")return"请输入正确的手机号码";if(t.accountType==="email"||t.inputType==="email")return"请输入正确的邮箱地址";if(t.type==="password"){if(r.value.isLengthValid){if(!r.value.hasUpperLowerNumber)return"密码需包含大小写字母及数字"}else return"密码长度应为8-20位";return"请输入正确的密码"}return"输入格式不正确"},Q=()=>{f.value=!0,S=setInterval(()=>{w.value>0?(w.value--,m.value="countdown_seconds"):(clearInterval(S),f.value=!1,m.value="resend_code",w.value=6)},1e3),console.log("验证码已发送")},K=e=>{Q();const l={captcha_id:"d9b22c2488def2cfa35aa4b6a4cbe74d",captcha_response:e.geetest_validate,challenge:I.value,type:t.verifyCodeType};if(t.accountType==="email")b.sendEmailVerifyCode({...l,email:t.account}).then(p=>{console.log(p),E.value=p.orderId});else if(t.accountType==="phone"){const p=new URLSearchParams(window.location.search).get("nationalCode")||localStorage.getItem("nationalCode")||"86";b.sendSMSVerifyCode({...l,national_code:p,mobile:t.account}).then(M=>{console.log(M),E.value=M.orderId})}},P=function(e){e.onReady(function(){console.log("验证码准备就绪")}).onSuccess(function(){const l=e.getValidate();if(!l)return alert("请完成验证");console.log("验证成功:",l),K(l)}),t.type==="code"&&setTimeout(()=>{const l=document.getElementById("sendCodeBtn");l&&l.addEventListener("click",function(){e.verify()})},100)},W=()=>{t.type==="code"&&b.register({captcha_id:"d9b22c2488def2cfa35aa4b6a4cbe74d"}).then(e=>{console.log("极验初始化成功:",e),I.value=e.challenge,window.initGeetest?(window.initGeetest({gt:e.gt,challenge:e.challenge,offline:!e.success,new_captcha:e.new_captcha,product:"bind"},P),t.autoGeetest&&C.value&&setTimeout(()=>{C.value&&C.value.click()},1e3)):console.error("极验初始化函数不存在")}).catch(e=>{console.error("极验初始化失败:",e)})},X=async()=>{try{const e=await navigator.clipboard.readText();a.value=e}catch(e){console.error("无法访问剪贴板:",e)}};return O(()=>{h.value=t.type!=="password",t.type==="code"&&W()}),J(()=>{S&&clearInterval(S)}),D({validate:()=>{const e=y();if(a.value)e?(A.value=!1,t.type==="password"?s("sendValue",a.value,!0):s("validChange",!0)):(A.value=!0,t.type==="password"?s("sendValue",a.value,!1):s("validChange",!1));else return A.value=!0,t.type==="password"?s("sendValue","",!1):s("validChange",!1),!1;return e},getValue:()=>a.value,setValue:e=>{a.value=e},clearError:()=>{A.value=!1,s("validChange",!0)},setError:()=>{A.value=!0,s("validChange",!1)},isEmpty:()=>!a.value,isValid:()=>y()}),(e,l)=>(u(),i("div",le,[c("label",ne,g(o.labelTitle),1),c("section",{class:v({borderNone:!d.value,error:t.hasError&&!d.value||t.type==="password"&&t.passwordError&&!d.value,focus:d.value}),style:B({"--width":`${o.width}px`,"--height":`${o.height}px`})},[q(c("input",{"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p),type:Y(),placeholder:o.placeholder,onFocus:R,onBlur:k,onInput:F},null,40,re),[[Z,a.value]]),o.type==="normal"?(u(),i("span",{key:0,class:"iconNormal",style:B({"--iconSize":`${o.iconSize}px`,"--iconUrl":`url(${o.iconUrl})`})},null,4)):o.type==="code"?(u(),i("button",{key:1,ref_key:"sendCodeBtn",ref:C,id:"sendCodeBtn",disabled:f.value,class:v([f.value?"contentColor":"brandColor"])},g(m.value==="countdown_seconds"?`${w.value}s`:e.$t(m.value)),11,ie)):o.type==="paste"?(u(),i("button",{key:2,onClick:X},g(e.$t("粘贴")),1)):o.type==="password"?(u(),i("span",{key:3,class:v(["showPasswordIcon",h.value?"eyeopen":"eyeclose"]),onClick:x},null,2)):T("",!0)],6),t.accountError||t.type==="password"&&t.passwordError?(u(),i("span",ce,g(e.$t(t.errorMessage||H())),1)):T("",!0),o.showCondition&&o.type==="password"?(u(),i("div",ue,[c("p",null,[c("span",{class:v(["condition",r.value.isLengthValid?"success":""]),style:B({backgroundImage:N(r.value.isLengthValid)})},null,6),z("   "+g(e.$t("密码为8-20位字符")),1)]),c("p",null,[c("span",{class:v(["condition",r.value.hasUpperLowerNumber?"success":""]),style:B({backgroundImage:N(r.value.hasUpperLowerNumber)})},null,6),z("   "+g(e.$t("包含大小写及数字")),1)])])):T("",!0)]))}},ye=ee(de,[["__scopeId","data-v-3a1bdba3"]]);export{ye as i};
