import{u as L,r as n,c as u,a as c,t as g,w as C,v as A,b as G,d as R,n as H,e as M,o as i,f as j,g as q,h as d,i as T,j as O,k as V,l as U,s as z}from"./index-DV7gJFYN.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as F}from"./accountInput-BRzQNCFt.js";import{a as E}from"./index-CJrAixGS.js";import{b as J}from"./bannerComponent-Bi7ZWIJ1.js";import{i as X}from"./inputPlus-Oq1Cn8tm.js";import"./help-CmPQ-lNE.js";const K={for:""},Q={class:"borderNone"},W=["placeholder"],Y={key:1},Z={key:2},x={key:3},ee={key:4},oe={__name:"superInput",props:{labelTitle:{type:String,default:""},type:{type:String,default:"normal"},placeholder:{type:String,default:""}},setup(l){const h=L();console.log(h.theme);const s=n(""),a=p=>{s.value=p.target.value,console.log(s.value)};return(p,r)=>(i(),u("div",null,[c("label",K,g(l.labelTitle),1),c("section",Q,[C(c("input",{type:"text",placeholder:l.placeholder,onInput:a,"onUpdate:modelValue":r[0]||(r[0]=v=>s.value=v)},null,40,W),[[A,s.value]]),c("div",null,[l.type==="normal"?C((i(),u("span",{key:0,class:"iconNormal",style:H({backgroundImage:"url(/images/"+M(h).theme+"/cancel.png)"})},null,4)),[[R,s.value.length>0]]):l.type==="password"?(i(),u("span",Y)):l.type==="code"?(i(),u("span",Z)):l.type==="inviteCode"?(i(),u("span",x)):l.type==="verifyCode"?(i(),u("span",ee)):G("",!0)])])]))}},te=S(oe,[["__scopeId","data-v-a3e2a9cb"]]),ae={class:"forgetPassword"},ne={id:"loginBtn",class:"login"},le={class:"toRegist"},se={__name:"login",setup(l){const h=U(),s=q(),a=n(""),p=n(""),r=n(""),v=n(""),b=n(!0),f=n(!0),m=n(!1),y=n(!1);let _=null;const k=()=>{a.value=="email"&&(a.value="")},I=e=>{a.value=e,console.log("账号类型已更新:",a.value)},$=e=>{b.value=e,m.value=!1,console.log("isAccountValid",b.value,"accountError",m.value)},B=e=>{console.log("passwordHandleValidChange",e),f.value=e,y.value=!1,console.log("isPasswordValid",f.value,"passwordError",y.value)},N=(e,o)=>{v.value=e,f.value=o},P=e=>{const o={captcha_id:"d9b22c2488def2cfa35aa4b6a4cbe74d",captcha_response:e.geetest_validate,challenge:p.value,password:v.value,username:r.value};a.value==="phone"&&(o.national_code=localStorage.getItem("nationalCode")||"86"),E.userLogin(o).then(t=>{console.log("登录成功:",t),h.push("/")}).catch(t=>{console.error("登录失败:",t),z(t.response.data.msg)})};var D=function(e){console.log("极验handler被调用"),_=e,_.onReady(function(){console.log("极验验证码准备就绪")}).onSuccess(function(){var o=_.getValidate();if(!o)return alert("请完成验证");P(o)}).onError(function(o){console.error("极验验证出错:",o)}),setTimeout(()=>{const o=document.getElementById("loginBtn");o&&o.addEventListener("click",function(){let t=!1;b.value===!1&&(m.value=!0,t=!0),f.value===!1&&(y.value=!0,t=!0),t||_.verify()})},500)};return j(()=>{if(s.path==="/login"&&s.query.from==="selectCountry"){a.value="phone";const e=sessionStorage.getItem("tempLoginData");if(e)try{const{account:o,type:t}=JSON.parse(e);a.value=t,r.value=o,sessionStorage.removeItem("tempLoginData"),setTimeout(()=>{const w=document.querySelector(".accountPanel input");w&&w.focus()},300)}catch(o){console.error("解析保存的账号数据失败:",o)}}console.log("组件挂载，初始化极验"),E.register({captcha_id:"d9b22c2488def2cfa35aa4b6a4cbe74d"}).then(e=>{console.log("极验初始化数据获取成功:",e),p.value=e.challenge,window.initGeetest?(console.log("调用initGeetest初始化极验"),window.initGeetest({gt:e.gt,challenge:e.challenge,offline:!e.success,new_captcha:e.new_captcha,product:"bind"},D)):console.error("未找到initGeetest函数")}).catch(e=>{console.error("获取极验初始化数据失败:",e)})}),(e,o)=>{const t=O("router-link");return i(),u("div",{class:"root",onClick:k},[d(J,{content:e.$t("登录您的CEEX专属账号")},null,8,["content"]),c("main",null,[d(F,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=w=>r.value=w),onTypeChange:I,onValidChange:$,from:"/login",accountError:m.value},null,8,["modelValue","accountError"]),d(X,{labelTitle:e.$t("密码"),placeholder:e.$t("密码"),type:"password",onSendValue:N,onValidChange:B,showErrorMessage:!0,passwordError:y.value},null,8,["labelTitle","placeholder","passwordError"]),c("div",ae,[d(t,{to:"/forgetPassword"},{default:T(()=>[V(g(e.$t("忘记密码")),1)]),_:1})]),c("button",ne,g(e.$t("登录")),1),c("div",le,[V(g(e.$t("还没账号"))+" ? ",1),d(t,{to:"/regist"},{default:T(()=>[V(g(e.$t("注册")),1)]),_:1})])]),d(te,{labelTitle:e.$t("验证码"),placeholder:e.$t("请输入验证码"),type:"normal"},null,8,["labelTitle","placeholder"])])}}},he=S(se,[["__scopeId","data-v-b8f4ca93"]]);export{he as default};
